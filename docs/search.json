[{"path":"https://ebabcock.github.io/PowerAfterChange/articles/UserGuide.html","id":"simulate-some-data","dir":"Articles","previous_headings":"","what":"Simulate some data","title":"User guide for power after change","text":"","code":"set.seed(123) #for reproducibility S_demo <- 12 #Number of sites nB_demo <- 5 #Number of before samples per site sd_within <- 2 #within-site standard deviation sd_between <- 1 #between-site standard deviation before_mean <- 10 #overall mean before change #simulate site to site variability siteMean <- rnorm(S_demo, mean = before_mean, sd = sd_between) #Genarate baseline data (before change) baseline_demo <- data.frame(   site = rep(1:S_demo, each = nB_demo)) %>%   mutate(y = rnorm(S_demo * nB_demo, mean = siteMean[site], sd = sd_within))"},{"path":"https://ebabcock.github.io/PowerAfterChange/articles/UserGuide.html","id":"estimate-within-site-sd","dir":"Articles","previous_headings":"","what":"Estimate within-site SD","title":"User guide for power after change","text":"need within-site standard deviation power sample size calculations. estimate baseline data. See getSD_within function PowerAfterFunctions code.","code":"sd_within_hat <-getSD_within(baseline = baseline_demo,                              siteVar = \"site\",                              responseVar = \"y\") sd_within_hat ## [1] 1.671255"},{"path":"https://ebabcock.github.io/PowerAfterChange/articles/UserGuide.html","id":"planning-assumptions","dir":"Articles","previous_headings":"","what":"Planning assumptions","title":"User guide for power after change","text":"change want able detect sufficient power.","code":"delta_target <- 1  #change in the mean we want to detect sd_delta <- 0.5  #variability in true changes among sites"},{"path":"https://ebabcock.github.io/PowerAfterChange/articles/UserGuide.html","id":"question-1-find-minimum-sites-given-before-and-after-number-known-sample-size","dir":"Articles","previous_headings":"","what":"(Question 1) Find minimum sites given before and after number known sample size","title":"User guide for power after change","text":"scenario, know many samples change, want know many sites needed achieve target power. equivalent paired t-test power calculation, simulation function power.t.test show equivalent calculate standard deviation difference correctly.  power curve shows power increases samples change. dashed red line indicates target power (0.8), dashed blue line indicates minimum number samples needed achieve power. Now, repeat calculation using standard power.t.test function comparison. standard deviation difference means per site calculated : sdif=(sdw2(1/nA+1/nB)+sdd2)s_{dif}=\\sqrt{(sd_w^2(1/n_A + 1/n_B) + sd_d^2}) combines: - Within-site variance measurements: sd_w^2/nA - Within-site variance measurements: sd_w^2/nB - -site variance true changes: sd_d^2 function getSD_difference makes calculation. can use power.t.test find number sites needed paired t-test. matches result simulation function find_min_sites. power curve.","code":"site_res <- find_min_sites(nB = nB_demo, nA = 5,                            delta = delta_target,                            sd_w = sd_within_hat, sd_d = sd_delta,                            target_power = 0.8, alpha = 0.05,                            S_grid = 2:40, nsim = 3000, seed = 42)  site_res$S_star ## [1] 13 # Plot power curve for sites ggplot(site_res$curve, aes(x = S, y = power)) +   geom_line() +   geom_hline(yintercept = 0.8, linetype = \"dashed\", color = \"red\") +   geom_vline(xintercept = site_res$S_star, linetype = \"dashed\", color = \"blue\") +   labs(title = \"Power Curve for Number of Sites, known before and after samples\",        x = \"Number of Sites\",        y = \"Power\") sd_diff_hat <- getSD_difference(sd_within = sd_within_hat,                                  nA = 5,                                  nB = 5,                                  sd_delta = sd_delta) sd_diff_hat ## [1] 1.169289 power_result <- power.t.test(n = NULL,                               delta = delta_target,                               sd = sd_diff_hat,                               sig.level = 0.05,                               power = 0.8,                               type = \"paired\",                               alternative = \"two.sided\") power_result$n  #Number of sites needed ## [1] 12.78393 comparison_df <- data.frame(   n_sites = site_res$curve$S,   power_analytical = find_min_sites_analytical(S_grid = site_res$curve$S,                                                      delta_target = delta_target,                                                      sd_diff = sd_diff_hat),   power_simulation = site_res$curve$power )  # Plot comparison ggplot(comparison_df, aes(x = n_sites)) +   geom_line(aes(y = power_analytical, color = \"power.t.test\"), size = 1) +   geom_line(aes(y = power_simulation, color = \"Simulation\"), size = 1, linetype = \"dashed\") +   geom_hline(yintercept = 0.8, linetype = \"dotted\", color = \"gray50\") +   geom_vline(xintercept = ceiling(power_result$n), linetype = \"dotted\", color = \"blue\", alpha = 0.5) +   geom_vline(xintercept = site_res$S_star, linetype = \"dotted\", color = \"red\", alpha = 0.5) +   labs(     title = \"Comparison: power.t.test vs Simulation-Based Power\",     subtitle = paste0(\"power.t.test: n=\", ceiling(power_result$n),                        \" | Simulation: n=\", site_res$S_star),     x = \"Number of Sites\",     y = \"Power\",     color = \"Method\"   ) +   scale_color_manual(values = c(\"power.t.test\" = \"blue\", \"Simulation\" = \"red\")) +   theme(legend.position = \"bottom\") ## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ## ℹ Please use `linewidth` instead. ## This warning is displayed once per session. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated."},{"path":"https://ebabcock.github.io/PowerAfterChange/articles/UserGuide.html","id":"question-2-find-minimum-n_after","dir":"Articles","previous_headings":"","what":"(Question 2) Find minimum n_after","title":"User guide for power after change","text":"scenario, fixed number sites samples change, want know many samples change needed achieve target power.function res_n_after finds minimum number samples change needed achieve target power, given number sites samples change. power curve shows power increases samples change. dashed red line indicates target power (0.8), dashed blue line indicates minimum number samples needed achieve power. Now, repeat calculation using standard power.t.test function comparison. standard deviation difference means per site calculated .  matches result simulation function find_n_after.","code":"res_n_after <- find_n_after(S = S_demo, nB = nB_demo,                     delta = delta_target,                     sd_w = sd_within_hat, sd_d = sd_delta,                     target_power = 0.8, alpha = 0.05,                     n_grid = 1:40, nsim = 3000, seed = 99) res_n_after$n_star  #Number of after samples need for specified power ## [1] 6 head(res_n_after$curve) ##   n_after     power ## 1       1 0.3646667 ## 2       2 0.5600000 ## 3       3 0.6833333 ## 4       4 0.7100000 ## 5       5 0.7620000 ## 6       6 0.8070000 # Plot power curve for number of samples after ggplot(res_n_after$curve, aes(x = n_after, y = power)) +   geom_line() +   geom_hline(yintercept = 0.8, linetype = \"dashed\", color = \"red\") +   geom_vline(xintercept = res_n_after$n_star, linetype = \"dashed\", color = \"blue\") +   labs(title = \"Power Curve for Before-After Design\",        x = \"Number of After Samples per Site\",        y = \"Power\") # Calculate power for a range of nA values nA_grid <- 1:40 power_values <- sapply(nA_grid, function(nA) {   power_for_nA(nA, S = S_demo, nB = nB_demo,                 delta = delta_target,                 sd_within = sd_within_hat,                 sd_delta = sd_delta,                 alpha = 0.05) }) # Create a data frame for plotting comparison_nA_df <- data.frame(   n_after = nA_grid,   power_analytical = power_values,   power_simulation = res_n_after$curve$power ) # Plot comparison ggplot(comparison_nA_df, aes(x = n_after)) +   geom_line(aes(y = power_analytical, color = \"power.t.test\"),             size = 1) +   geom_line(aes(y = power_simulation, color = \"Simulation\"),             size = 1, linetype = \"dashed\") +   geom_hline(yintercept = 0.8, linetype = \"dotted\", color = \"gray50\") +   geom_vline(xintercept = ceiling(res_n_after$n_star),              linetype = \"dotted\", color = \"red\", alpha = 0.5) +   labs(     title = \"Comparison: power.t.test vs Simulation-Based Power\",     subtitle = paste0(\"power.t.test: nA=\", ceiling(res_n_after$n_star     ), \" | Simulation: nA=\", res_n_after$n_star),     x = \"Number of After Samples per Site\",     y = \"Power\",     color = \"Method\"   ) +   scale_color_manual(values = c(\"power.t.test\" = \"blue\",                                 \"Simulation\" = \"red\")) +   theme(legend.position = \"bottom\")"},{"path":"https://ebabcock.github.io/PowerAfterChange/articles/UserGuide.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"User guide for power after change","text":"simulation-based functions produce results align closely analytical solutions power.t.test standard deviation difference calculated correctly. validates simulation approach power sample size calculations -designs fixed sites repeated samples per site. can now add biological realism using functions normal simulation, adding complex designs.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Elizabeth Babcock. Author, maintainer.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Babcock E (2026). PowerAfterChange: Calculations power detect change ecological data. R package version 0.1.0, https://ebabcock.github.io/PowerAfterChange/.","code":"@Manual{,   title = {PowerAfterChange: Calculations of power to detect a change in ecological data},   author = {Elizabeth A Babcock},   year = {2026},   note = {R package version 0.1.0},   url = {https://ebabcock.github.io/PowerAfterChange/}, }"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"find_min_sites — find_min_sites","title":"find_min_sites — find_min_sites","text":"Function find minimum number sites needed achieve target power paired t test means across observations sites changepoint.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find_min_sites — find_min_sites","text":"","code":"find_min_sites(   nB,   nA,   delta,   sd_w,   sd_d = 0,   target_power = 0.8,   alpha = 0.05,   S_grid = 2:50,   nsim = 2000,   seed = 1 )"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"find_min_sites — find_min_sites","text":"nB Number measurements per site nA Number measurements per site delta Hypothesized mean change sd_w Within-site standard deviation sd_d -site standard deviation true changes target_power Desired power level achieve alpha Significance level, defaults 0.05 S_grid Grid site numbers evaluate nsim Number simulations run seed Random seed reproducibility","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"find_min_sites — find_min_sites","text":"list containing minimum number sites needed achieve target power data frame power curve","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites_analytical.html","id":null,"dir":"Reference","previous_headings":"","what":"find_min_sites_analytical — find_min_sites_analytical","title":"find_min_sites_analytical — find_min_sites_analytical","text":"Function use power.t.test calculate power paired t-test means across","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites_analytical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find_min_sites_analytical — find_min_sites_analytical","text":"","code":"find_min_sites_analytical(S_grid, delta_target, sd_diff)"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites_analytical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"find_min_sites_analytical — find_min_sites_analytical","text":"delta_target Target mean change sd_diff Standard deviation difference means n_grid Number sites grid","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_min_sites_analytical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"find_min_sites_analytical — find_min_sites_analytical","text":"Power number sites n_grid","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_n_after.html","id":null,"dir":"Reference","previous_headings":"","what":"find_n_after — find_n_after","title":"find_n_after — find_n_after","text":"Function find minimum number measurements needed achieve target power, paired t-test means.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_n_after.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"find_n_after — find_n_after","text":"","code":"find_n_after(   S,   nB,   delta,   sd_w,   sd_d = 0,   target_power = 0.8,   alpha = 0.05,   n_grid = 1:50,   nsim = 2000,   seed = 1 )"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_n_after.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"find_n_after — find_n_after","text":"S Number sites nB Number measurements per site delta Hypothesized mean change sd_w Within-site standard deviation sd_d -site standard deviation true changes target_power Desired power level achieve alpha Significance level, defaults 0.05 n_grid Grid measurements evaluate nsim Number simulations run seed Random seed reproducibility","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/find_n_after.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"find_n_after — find_n_after","text":"list containing minimum number measurements needed achieve target power data frame power curve","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_difference.html","id":null,"dir":"Reference","previous_headings":"","what":"getSD_difference — getSD_difference","title":"getSD_difference — getSD_difference","text":"Estimate standard deviation difference means change paired t-test difference means.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_difference.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"getSD_difference — getSD_difference","text":"","code":"getSD_difference(sd_within, nA, nB, sd_delta)"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_difference.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"getSD_difference — getSD_difference","text":"sd_within standard deviation within sites nA number samples per site nB number samples per site sd_delta standard deviation true changes among sites","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_difference.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"getSD_difference — getSD_difference","text":"Standard deviation difference means","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_within.html","id":null,"dir":"Reference","previous_headings":"","what":"getSD_within — getSD_within","title":"getSD_within — getSD_within","text":"Estimate within-site standard deviation baseline data.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_within.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"getSD_within — getSD_within","text":"","code":"getSD_within(baseline, siteVar = \"site\", responseVar = \"y\")"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_within.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"getSD_within — getSD_within","text":"baseline Data frame containing baseline measurements siteVar Name site variable baseline data responseVar Name response variable baseline data","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/getSD_within.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"getSD_within — getSD_within","text":"Estimated within-site standard deviation","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_nA.html","id":null,"dir":"Reference","previous_headings":"","what":"power_for_nA Function to calculate power for given number of after samples for a paire t-test of the difference in means before vs. after change using power.t.test — power_for_nA","title":"power_for_nA Function to calculate power for given number of after samples for a paire t-test of the difference in means before vs. after change using power.t.test — power_for_nA","text":"power_for_nA Function calculate power given number samples paire t-test difference means vs. change using power.t.test","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_nA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"power_for_nA Function to calculate power for given number of after samples for a paire t-test of the difference in means before vs. after change using power.t.test — power_for_nA","text":"","code":"power_for_nA(nA, S, nB, delta, sd_within, sd_delta, alpha)"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_nA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"power_for_nA Function to calculate power for given number of after samples for a paire t-test of the difference in means before vs. after change using power.t.test — power_for_nA","text":"nA Number samples per site S Number sites nB Number samples per site delta Hypothesized mean change sd_within Standard deviation within sites sd_delta Standard deviation true changes among sites alpha Significance level","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_nA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"power_for_nA Function to calculate power for given number of after samples for a paire t-test of the difference in means before vs. after change using power.t.test — power_for_nA","text":"Power given number sample","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_n_after.html","id":null,"dir":"Reference","previous_headings":"","what":"power_for_n_after — power_for_n_after","title":"power_for_n_after — power_for_n_after","text":"Estimate power paired t-test average given number measurements fixed number sites changepoint.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_n_after.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"power_for_n_after — power_for_n_after","text":"","code":"power_for_n_after(   S,   nB,   nA,   delta,   sd_w,   sd_d = 0,   alpha = 0.05,   nsim = 2000,   seed = 1 )"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_n_after.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"power_for_n_after — power_for_n_after","text":"S Number sites nB Number measurements per site nA Number measurements per site delta Hypothesized mean change sd_w Within-site standard deviation sd_d -site standard deviation true changes alpha Significance level, defaults 0.05 nsim Number simulations run seed Random seed reproducibility","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_n_after.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"power_for_n_after — power_for_n_after","text":"Estimated power given number measurements","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_sites.html","id":null,"dir":"Reference","previous_headings":"","what":"power_for_sites — power_for_sites","title":"power_for_sites — power_for_sites","text":"Function estimate power paired t-test average given number sites changepoint.","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_sites.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"power_for_sites — power_for_sites","text":"","code":"power_for_sites(   S,   nB,   nA,   delta,   sd_w,   sd_d = 0,   alpha = 0.05,   nsim = 2000,   seed = 1 )"},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_sites.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"power_for_sites — power_for_sites","text":"S Number sites nB Number measurements per site nA Number measurements per site delta Hypothesized mean change sd_w Within-site standard deviation sd_d -site standard deviation true changes alpha Significance level, defaults 0.05 nsim Number simulations run seed Random seed reproducibility","code":""},{"path":"https://ebabcock.github.io/PowerAfterChange/reference/power_for_sites.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"power_for_sites — power_for_sites","text":"Estimated power given number sites","code":""}]
